sap.ui.define(["sap/m/Toolbar","sap/m/ToolbarRenderer","sap/m/Select","sap/m/Button","sap/m/Title","sap/m/ToolbarSpacer","sap/m/SearchField","sap/ui/core/Item","sap/ui/core/format/DateFormat","sap/m/Dialog","sap/m/DateRangeSelection"],function(t,e,a,s,i,n,r,h,o,_,l){return t.extend("encollab.dp.controls.SearchToolbar",{metadata:{properties:{},events:{search:{},filter:{}}},renderer:function(t,a){e.render(t,a)},getFirst:function(){return this._first},getLast:function(){return this._last},getDateRange:function(){return{first:this._first,last:this._last}},init:function(){t.prototype.init.apply(this,arguments);this._date=new Date;this._navigate=0;this._first=null;this._last=null;this._key="t";this._formatter=o.getDateTimeInstance({pattern:"dd MMM yyyy"});this._daterange=new l({maxDate:new Date});this._dialog=new _({title:"Pick a date range",content:[this._daterange],buttons:[new s({text:"Cancel",press:this._onDialogCancel.bind(this)}),new s({text:"Confirm",press:this._onDialogConfirm.bind(this)})]});this._buttonForward=new s({icon:"sap-icon://navigation-right-arrow",press:this._forward.bind(this)});this._buttonBack=new s({icon:"sap-icon://navigation-left-arrow",press:this._backward.bind(this)});this._textPeriod=new i({text:"This week"});this._textDates=new i({text:"NULL"});this._search=new r({width:"30%",search:this._onChange.bind(this)});this._period=new a({change:this._onSelect.bind(this),items:[new h({key:"t",text:"Day"}),new h({key:"w",text:"Week"}),new h({key:"m",text:"Month"}),new h({key:"q",text:"Quarter"}),new h({key:"y",text:"Year"}),new h({key:"c",text:"Custom"})]});this.addContent(this._buttonBack);this.addContent(this._buttonForward);this.addContent(this._textPeriod);this.addContent(this._textDates);this.addContent(new n);this.addContent(this._search);this.addContent(this._period);this._setDates()},_setDates:function(t){var e,a,s;switch(this._key){case"t":this._setToday();s="Day";break;case"w":this._setDateDay();s="Week";break;case"m":this._setDateMonth();s="Month";break;case"q":this._setDateQuarter();s="Quarter";break;case"y":this._setDateYear();s="Year";break;case"c":s="Range";this._dialog.open();break}if(this._key!=="c"){switch(this._navigate){case-1:s=this._key==="t"?"Yesterday":"Last "+s.toLowerCase();break;case 0:s=this._key==="t"?"Today":"This "+s.toLowerCase();break;case 1:s=this._key==="t"?"Tomorrow":"Next "+s.toLowerCase();break}}this._textPeriod.setText(s+": ");if(this._key==="t"){this._textDates.setText(this._formatter.format(this._first))}else{this._textDates.setText(this._formatter.format(this._first)+" - "+this._formatter.format(this._last))}if(t===true){this.fireSearch({first:this._first,last:this._last})}},_onDialogCancel:function(t){this._dialog.close()},_onDialogConfirm:function(t){this._first=this._daterange.getDateValue();this._last=this._daterange.getSecondDateValue();this._dialog.close();this._setDates(true)},_setDateDay:function(){var t=this._navigate*7*-1;var e=new Date(this._date-(this._date.getDay()+t)*1e3*60*60*24);var a=new Date(e.getTime()+7*1e3*60*60*24);this._first=new Date(e.getFullYear(),e.getMonth(),e.getDate());this._last=new Date(a.getFullYear(),a.getMonth(),a.getDate())},_setDateMonth:function(){this._first=new Date(this._date.getFullYear(),this._date.getMonth()+this._navigate,1);this._last=new Date(this._date.getFullYear(),this._date.getMonth()+this._navigate+1,0)},_setDateQuarter:function(){var t=Math.floor(this._date.getMonth()/3)+this._navigate;this._first=new Date(this._date.getFullYear(),t*3,1);this._last=new Date(this._date.getFullYear(),(t+1)*3,0)},_setDateYear:function(){this._first=new Date(this._date.getFullYear()+this._navigate,0,1);this._last=new Date(this._date.getFullYear()+this._navigate+1,0,0)},_setToday:function(){this._first=new Date(this._date.getTime()+this._navigate*1e3*60*60*24);this._last=new Date(this._date.getTime()+this._navigate*1e3*60*60*24)},_onChange:function(){this.fireFilter({filter:this._search.getValue()})},_onSelect:function(t){this._navigate=0;this._key=this._period.getSelectedKey();var e=true;if(this._key==="c"){this._dialog.open();e=false}else{this._setDates(true)}this._buttonForward.setEnabled(e);this._buttonBack.setEnabled(e)},_forward:function(){this._navigate++;this._setDates(true)},_backward:function(){this._navigate--;this._setDates(true)},onAfterRendering:function(){this._setDates(false)}})});
//# sourceMappingURL=SearchToolbar-dbg.js.map